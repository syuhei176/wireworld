<html>
<head>
<meta charset="UTF-8">
<script src="http://cdn.mlkcca.com/v2.1/milkcocoa.js"></script>
<script src="jquery-1.10.2.min.js"></script>
<script src="snap.svg-min.js"></script>
<script src="cellautomaton.js"></script>
<script src="wireworld.js"></script>
<script src="view.js"></script>
<style>
.menu {
position: fixed; 
}
</style>
<script>
$(function() {
	var milkcocoa = new MilkCocoa("https://mlkcca.com", "mlkdev-000m", function() {});
	var ds = milkcocoa.DataStore("map");
	var view = new View(30, 30, ds);
	var wireworld = WireWorld(function(x, y, state) {
		if(state == 0) {
			view.change(x, y, "#232323");
		}else if(state == 1) {
			view.change(x, y, "#ffff00");
		}else if(state == 2) {
			view.change(x, y, "#0000ff");
		}else if(state == 3) {
			view.change(x, y, "#ff0000");
		}
	});
	view.init(wireworld);
	wireworld.refresh();
	ds.get(function(e){
		for(var key in e) {
			if(key == 'id' || key == 'path') continue;
			var pos = key.split('-');
			var x = Number(pos[0]);
			var y = Number(pos[1]);
			wireworld.set(x, y, Number(e[key]));
		}
		setInterval(function(){
			wireworld.step();
		}, 500);
	});
})
</script>
</head>

<body>
<svg id="svg" width="1024px" height="1024px"></svg>
</body>
</html>